<html>
	<head>
		<title>Canvas test</title>
		<script type="text/javascript">
			var ctx;
			var SRAM = [];

			function initSRAM() {
				for (var addr=0; addr<262144; addr++) {
					SRAM[addr] = ((addr & 0xFF) << 8) | (addr & 0xFF);
				}
			}

			function drawPx(x, y, r, g, b) {
				ctx.fillStyle = "rgba("+r+","+g+","+b+",1)";
				ctx.fillRect(x, y, 1, 1);
			}

			function draw() {
				initSRAM();
				for (var y=0; y<480; y++) {
					for (var x=0; x<800; x+=2) {
						var addr = ((y & 511) << 9) | (x >> 1);
						// {ypx[8:0], r_SRAM2LBAddr[9:1]}
						var val1 = (SRAM[addr] & 0xFF00) >> 8;
						var r1 =  val1 & 224;
						var g1 = (val1 & 28) << 3;
						var b1 = (val1 &  3) << 6;
						drawPx(x, y, r1, g1, b1);

						var val2 = (SRAM[addr] & 0xFF00) >> 8;
						var r2 =  val2 & 224;
						var g2 = (val2 & 28) << 3;
						var b2 = (val2 &  3) << 6;
						drawPx(x, y, r2, g2, b2);
					}
				}
			}

			function canvasTest() {
				var canvas = document.getElementById('cvs');
				if (canvas.getContext) {
					ctx = canvas.getContext('2d');
				}
				draw();
			}
		</script>
	</head>
	<body onload="canvasTest();">
		<canvas id="cvs" width="800" height="480"></canvas>
	</body>
</html>
